# üöÄ –ö–û–ú–ê–ù–î–´ –î–õ–Ø –î–ï–ü–õ–û–Ø

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è `migrate_add_updated_at()` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ - —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `custom_reminders`
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã: 5/5 (100%)
- ‚úÖ –õ–∏–Ω—Ç–µ—Ä: 0 –æ—à–∏–±–æ–∫

---

## üìã –í–ê–†–ò–ê–ù–¢ 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

### –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```powershell
.\deploy_now.ps1
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –°–æ–∑–¥–∞—Å—Ç –∫–æ–º–º–∏—Ç —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
2. –°–¥–µ–ª–∞–µ—Ç push –≤ Git
3. –û–±–Ω–æ–≤–∏—Ç –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
4. **–ó–∞–ø—É—Å—Ç–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ)**
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –±–æ—Ç–∞
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç —Å—Ç–∞—Ç—É—Å

---

## üìã –í–ê–†–ò–ê–ù–¢ 2: –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (–ø–æ—à–∞–≥–æ–≤–æ)

### –®–∞–≥ 1: –ö–æ–º–º–∏—Ç –∏ push
```powershell
git add app/database/migrations.py
git commit -m "Fix: migrations - check custom_reminders table existence before altering"
git push
```

### –®–∞–≥ 2: SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```powershell
ssh -i "$env:USERPROFILE\.ssh\id_ed25519" root@213.108.21.142
```

### –®–∞–≥ 3: –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å
```bash
# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /root/water-reminder

# –ü–æ–ª—É—á–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏
source venv/bin/activate
python run_migrations.py

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
systemctl restart water_bot

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
systemctl status water_bot
```

---

## üîç –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–π
```bash
journalctl -u water_bot -n 100 | grep -A5 "–ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üîÑ –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...
‚úì –ö–æ–ª–æ–Ω–∫–∞ updated_at —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ water_reminders
‚úì –¢–∞–±–ª–∏—Ü–∞ custom_reminders –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—É–∂–µ —É–¥–∞–ª–µ–Ω–∞ –∏–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å)
‚úì –¢–∞–±–ª–∏—Ü–∞ custom_reminders –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚úì –¢–∞–±–ª–∏—Ü–∞ water_reminder_history –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚úì –ö–æ–ª–æ–Ω–∫–∞ onboarding_completed —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ water_reminders
‚úÖ –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
```bash
journalctl -u water_bot -n 50 -f
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –∑–∞–ø–∏—Å–∏:**
```
‚úÖ Application –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
üîÑ --- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ –ë–î ---
üìä –ù–∞–π–¥–µ–Ω–æ N –∞–∫—Ç–∏–≤–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ –≤–æ–¥–µ
‚úÖ --- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ ---
üìã –í—Å–µ–≥–æ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á: X
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å QA —Ç–µ—Å—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
cd /root/water-reminder
python test_multiuser_qa.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–ü—Ä–æ–π–¥–µ–Ω–æ: 5/5
–£—Å–ø–µ—à–Ω–æ—Å—Ç—å: 100.0%
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```bash
sqlite3 /root/water-reminder/reminders.db "SELECT chat_id, is_active, onboarding_completed FROM water_reminders;"
```

---

## ‚ö†Ô∏è –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø

### –ü—Ä–æ–±–ª–µ–º–∞: "Warning: Identity file not accessible"
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ - SSH –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–º—É –º–µ—Ç–æ–¥—É

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
journalctl -u water_bot -n 200 | grep -i error
```
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ Python –ø–∞–∫–µ—Ç–æ–≤:
```bash
cd /root/water-reminder
source venv/bin/activate
pip install -r requirements.txt
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–∞–¥–∞—é—Ç
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î:
```bash
sqlite3 /root/water-reminder/reminders.db ".tables"
sqlite3 /root/water-reminder/reminders.db ".schema water_reminders"
```

---

## üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞
systemctl status water_bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –õ–æ–≥–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫)
journalctl -u water_bot -n 100

# –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: QA —Ç–µ—Å—Ç—ã
cd /root/water-reminder && python test_multiuser_qa.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á
journalctl -u water_bot | grep "–í—Å–µ–≥–æ –∑–∞–¥–∞—á –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ"
```

---

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–®–ù–û–ì–û –î–ï–ü–õ–û–Ø

- [ ] ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] ‚úÖ –ë–æ—Ç –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (—Å—Ç–∞—Ç—É—Å: active (running))
- [ ] ‚úÖ –ó–∞–¥–∞—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ –ë–î
- [ ] ‚úÖ QA —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (5/5)
- [ ] ‚úÖ –í –ª–æ–≥–∞—Ö –Ω–µ—Ç –æ—à–∏–±–æ–∫

---

## üéâ –ì–û–¢–û–í–û!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –±–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏!

**–í–µ—Ä—Å–∏—è:** 2.1.1-migration-fix  
**–î–∞—Ç–∞:** 5 –Ω–æ—è–±—Ä—è 2024

